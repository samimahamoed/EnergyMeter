\hypertarget{a00041}{\section{spi\-\_\-ade7880\-\_\-protocol.\-h}
\label{dd/d32/a00041}\index{spi\-\_\-ade7880\-\_\-protocol.\-h@{spi\-\_\-ade7880\-\_\-protocol.\-h}}
}

\begin{DoxyCode}
00001 
00006 \textcolor{preprocessor}{#ifndef \_\_SRV\_ADE7880\_PROTOCOL\_H}
00007 \textcolor{preprocessor}{}\textcolor{preprocessor}{#define \_\_SRV\_ADE7880\_PROTOCOL\_H}
00008 \textcolor{preprocessor}{}
00009 
00010 
00011 
\hypertarget{a00041_source_l00012}{}\hyperlink{a00041_a30e8f63608e6153585d75dc479a03177}{00012} \textcolor{preprocessor}{#define ADE7880\_RD                  1}
\hypertarget{a00041_source_l00013}{}\hyperlink{a00041_a36352e0d88dc7c5ede031013c75a678f}{00013} \textcolor{preprocessor}{}\textcolor{preprocessor}{#define ADE7880\_WR                  0}
\hypertarget{a00041_source_l00014}{}\hyperlink{a00041_af87bc226c5bc1e648d8ceac69ccf2bcb}{00014} \textcolor{preprocessor}{}\textcolor{preprocessor}{#define DUMMY\_MSG                   0x00000000}
\hypertarget{a00041_source_l00015}{}\hyperlink{a00041_a0f0795755fb9e8e47c78c1289e091282}{00015} \textcolor{preprocessor}{}\textcolor{preprocessor}{#define RD\_MSG\_LENGTH               3            }
\hypertarget{a00041_source_l00016}{}\hyperlink{a00041_ac85ecf34a5cbd85d6dbd51b4c9a5469e}{00016} \textcolor{preprocessor}{}\textcolor{preprocessor}{#define WR\_MSG\_LENGTH               3       }
\hypertarget{a00041_source_l00017}{}\hyperlink{a00041_ab38a2f23d72262bab020eb973958f37b}{00017} \textcolor{preprocessor}{}\textcolor{preprocessor}{#define RAM\_LOCK\_MSG\_LENGTH         4   }
\hypertarget{a00041_source_l00018}{}\hyperlink{a00041_a4dc3b9b3e720309f9ebbb2d93768ed4f}{00018} \textcolor{preprocessor}{}\textcolor{preprocessor}{#define REG\_LENGTH(\_x)              (sizeof(\_x))}
00019 \textcolor{preprocessor}{}    
\hypertarget{a00041_source_l00021}{}\hyperlink{a00011}{00021} \textcolor{keyword}{typedef} \textcolor{keyword}{union}
00022 \{
\hypertarget{a00041_source_l00023}{}\hyperlink{a00011_a7bf6defa0ae3fb2bca057a3a97d4f740}{00023}     uint8\_t \hyperlink{a00011_a7bf6defa0ae3fb2bca057a3a97d4f740}{address\_all};
00024     \textcolor{keyword}{struct}
00025     \{
\hypertarget{a00041_source_l00026}{}\hyperlink{a00011_a97e2668c8e5470fa66185f16dc2e8045}{00026}         uint8\_t RD\_WR:1;
\hypertarget{a00041_source_l00027}{}\hyperlink{a00011_a935ee6f74a5c245878a724b16c4b06b7}{00027}         uint8\_t chip\_address:7;
00028     \}bits;
00029 
00030 \}\hyperlink{a00011}{address\_byte\_ut};
00031 
\hypertarget{a00041_source_l00032}{}\hyperlink{a00034}{00032} \textcolor{keyword}{typedef} \textcolor{keyword}{union}\{
\hypertarget{a00041_source_l00033}{}\hyperlink{a00034_a90b3f782e917edca7101e7803a3773b7}{00033} uint8\_t         \hyperlink{a00034_a90b3f782e917edca7101e7803a3773b7}{reg8};
\hypertarget{a00041_source_l00034}{}\hyperlink{a00034_a0c22d234d52e616d449a8c264bf2030b}{00034} uint16\_t        \hyperlink{a00034_a0c22d234d52e616d449a8c264bf2030b}{reg16};
\hypertarget{a00041_source_l00035}{}\hyperlink{a00034_a83e2be8d3feb1bcbc286bfaae10ac552}{00035} uint32\_t        \hyperlink{a00034_a83e2be8d3feb1bcbc286bfaae10ac552}{reg32};
00036 \}\hyperlink{a00034}{value\_ut};
00037 
\hypertarget{a00041_source_l00039}{}\hyperlink{a00014}{00039} \textcolor{keyword}{typedef} \textcolor{keyword}{union}
00040 \{
00041     uint8\_t msg\_all[\hyperlink{a00041_a0f0795755fb9e8e47c78c1289e091282}{RD\_MSG\_LENGTH} + \textcolor{keyword}{sizeof}(uint32\_t)]  
      \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00042     
00043     \textcolor{keyword}{struct}
00044     \{   
\hypertarget{a00041_source_l00045}{}\hyperlink{a00014_af6a65bac733ea3e9b1d24b065163d49a}{00045}     \hyperlink{a00011}{address\_byte\_ut} \hyperlink{a00014_af6a65bac733ea3e9b1d24b065163d49a}{address\_byte} ;
00046     uint16\_t        \hyperlink{a00041_ac02048009fa6718e40f028b6bae63f3d}{target\_register} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00047     uint32\_t        \hyperlink{a00041_aa11432305021ed2018866e1f8e990c34}{rc\_arg} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00048     \}msg\_fields  \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
\hypertarget{a00041_source_l00049}{}\hyperlink{a00041_af6a65bac733ea3e9b1d24b065163d49a}{00049}     
00050 \}\hyperlink{a00014}{ade7880\_read32\_tx\_buff\_ut};
00051 
00052 
\hypertarget{a00041_source_l00054}{}\hyperlink{a00013}{00054} \textcolor{keyword}{typedef} \textcolor{keyword}{union}
00055 \{
00056     uint8\_t msg\_all[\hyperlink{a00041_a0f0795755fb9e8e47c78c1289e091282}{RD\_MSG\_LENGTH} + \textcolor{keyword}{sizeof}(uint16\_t)]  
      \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00057     
00058     \textcolor{keyword}{struct}
00059     \{   
\hypertarget{a00041_source_l00060}{}\hyperlink{a00013_af6a65bac733ea3e9b1d24b065163d49a}{00060}     \hyperlink{a00011}{address\_byte\_ut} \hyperlink{a00013_af6a65bac733ea3e9b1d24b065163d49a}{address\_byte};
00061     uint16\_t        \hyperlink{a00041_ac02048009fa6718e40f028b6bae63f3d}{target\_register} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00062     uint16\_t        \hyperlink{a00041_aa11432305021ed2018866e1f8e990c34}{rc\_arg} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00063     \}msg\_fields  \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00064     
00065 \}\hyperlink{a00013}{ade7880\_read16\_tx\_buff\_ut};
00066 
00067 
\hypertarget{a00041_source_l00069}{}\hyperlink{a00015}{00069} \textcolor{keyword}{typedef} \textcolor{keyword}{union}
00070 \{
00071     uint8\_t msg\_all[\hyperlink{a00041_a0f0795755fb9e8e47c78c1289e091282}{RD\_MSG\_LENGTH} + \textcolor{keyword}{sizeof}(uint8\_t)]  \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00072     
00073     \textcolor{keyword}{struct}
00074     \{   
\hypertarget{a00041_source_l00075}{}\hyperlink{a00015_af6a65bac733ea3e9b1d24b065163d49a}{00075}     \hyperlink{a00011}{address\_byte\_ut} \hyperlink{a00015_af6a65bac733ea3e9b1d24b065163d49a}{address\_byte};
00076     uint16\_t        \hyperlink{a00041_ac02048009fa6718e40f028b6bae63f3d}{target\_register} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
\hypertarget{a00041_source_l00077}{}\hyperlink{a00015_aa11432305021ed2018866e1f8e990c34}{00077}     uint8\_t         \hyperlink{a00015_aa11432305021ed2018866e1f8e990c34}{rc\_arg};
00078     \}msg\_fields  \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00079     
00080 \}\hyperlink{a00015}{ade7880\_read8\_tx\_buff\_ut};
\hypertarget{a00041_source_l00081}{}\hyperlink{a00041_aa11432305021ed2018866e1f8e990c34}{00081} 
00082 
00083 
\hypertarget{a00041_source_l00085}{}\hyperlink{a00018}{00085} \textcolor{keyword}{typedef} \textcolor{keyword}{union}
00086 \{
00087     uint8\_t msg\_all[\hyperlink{a00041_ac85ecf34a5cbd85d6dbd51b4c9a5469e}{WR\_MSG\_LENGTH} + \textcolor{keyword}{sizeof}(uint32\_t)]  
      \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00088     
00089     \textcolor{keyword}{struct}
00090     \{   
\hypertarget{a00041_source_l00091}{}\hyperlink{a00018_af6a65bac733ea3e9b1d24b065163d49a}{00091}     \hyperlink{a00011}{address\_byte\_ut} \hyperlink{a00018_af6a65bac733ea3e9b1d24b065163d49a}{address\_byte};
00092     uint16\_t        \hyperlink{a00041_ac02048009fa6718e40f028b6bae63f3d}{target\_register} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00093     uint32\_t        \hyperlink{a00041_a638e4503e0ae6ce655b7ad2e17e8f0ad}{value} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00094     \}msg\_fields  \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00095     
00096 \}\hyperlink{a00018}{ade7880\_write32\_tx\_buff\_ut};
00097 
00098 
00099 
\hypertarget{a00041_source_l00101}{}\hyperlink{a00017}{00101} \textcolor{keyword}{typedef} \textcolor{keyword}{union}
00102 \{
00103     uint8\_t msg\_all[\hyperlink{a00041_ac85ecf34a5cbd85d6dbd51b4c9a5469e}{WR\_MSG\_LENGTH} + \textcolor{keyword}{sizeof}(uint16\_t)]  
      \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00104     
00105     \textcolor{keyword}{struct}
00106     \{   
\hypertarget{a00041_source_l00107}{}\hyperlink{a00017_af6a65bac733ea3e9b1d24b065163d49a}{00107}     \hyperlink{a00011}{address\_byte\_ut} \hyperlink{a00017_af6a65bac733ea3e9b1d24b065163d49a}{address\_byte};
00108     uint16\_t        \hyperlink{a00041_ac02048009fa6718e40f028b6bae63f3d}{target\_register} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00109     uint16\_t        \hyperlink{a00041_a638e4503e0ae6ce655b7ad2e17e8f0ad}{value} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00110     \}msg\_fields  \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00111     
00112 \}\hyperlink{a00017}{ade7880\_write16\_tx\_buff\_ut};
00113 
00114 
00115 
00116 
00117 
\hypertarget{a00041_source_l00119}{}\hyperlink{a00019}{00119} \textcolor{keyword}{typedef} \textcolor{keyword}{union}
00120 \{
00121     uint8\_t msg\_all[\hyperlink{a00041_ac85ecf34a5cbd85d6dbd51b4c9a5469e}{WR\_MSG\_LENGTH} + \textcolor{keyword}{sizeof}(uint32\_t)]  
      \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00122     
00123     \textcolor{keyword}{struct}
00124     \{   
\hypertarget{a00041_source_l00125}{}\hyperlink{a00019_af6a65bac733ea3e9b1d24b065163d49a}{00125}     \hyperlink{a00011}{address\_byte\_ut} \hyperlink{a00019_af6a65bac733ea3e9b1d24b065163d49a}{address\_byte};
\hypertarget{a00041_source_l00126}{}\hyperlink{a00019_ac02048009fa6718e40f028b6bae63f3d}{00126}     uint16\_t        \hyperlink{a00019_ac02048009fa6718e40f028b6bae63f3d}{target\_register};
00127         \textcolor{keyword}{union}\{
\hypertarget{a00041_source_l00128}{}\hyperlink{a00019_a90b3f782e917edca7101e7803a3773b7}{00128}         uint8\_t         \hyperlink{a00019_a90b3f782e917edca7101e7803a3773b7}{reg8};
00129         uint16\_t        \hyperlink{a00041_a0c22d234d52e616d449a8c264bf2030b}{reg16} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00130         uint32\_t        \hyperlink{a00041_a83e2be8d3feb1bcbc286bfaae10ac552}{reg32} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00131         \}\hyperlink{a00041_a638e4503e0ae6ce655b7ad2e17e8f0ad}{value};
00132     \}msg\_fields  \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00133     
\hypertarget{a00041_source_l00134}{}\hyperlink{a00041_ac02048009fa6718e40f028b6bae63f3d}{00134} \}\hyperlink{a00019}{ade7880\_write8\_tx\_buff\_ut};
00135 
\hypertarget{a00041_source_l00136}{}\hyperlink{a00041_a90b3f782e917edca7101e7803a3773b7}{00136} 
00137 
00138 
\hypertarget{a00041_source_l00140}{}\hyperlink{a00016}{00140} \textcolor{keyword}{typedef} \textcolor{keyword}{union}
00141 \{
00142     uint8\_t msg\_all[\hyperlink{a00041_ac85ecf34a5cbd85d6dbd51b4c9a5469e}{WR\_MSG\_LENGTH} + \textcolor{keyword}{sizeof}(uint32\_t)]  
      \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00143     
00144     \textcolor{keyword}{struct}
00145     \{   
\hypertarget{a00041_source_l00146}{}\hyperlink{a00016_af6a65bac733ea3e9b1d24b065163d49a}{00146}     \hyperlink{a00011}{address\_byte\_ut} \hyperlink{a00016_af6a65bac733ea3e9b1d24b065163d49a}{address\_byte};
00147     uint16\_t        target\_register \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00148     \textcolor{keyword}{union}\{
\hypertarget{a00041_source_l00149}{}\hyperlink{a00016_a90b3f782e917edca7101e7803a3773b7}{00149}         uint8\_t         \hyperlink{a00016_a90b3f782e917edca7101e7803a3773b7}{reg8};
\hypertarget{a00041_source_l00150}{}\hyperlink{a00016_a0c22d234d52e616d449a8c264bf2030b}{00150}         uint16\_t        \hyperlink{a00016_a0c22d234d52e616d449a8c264bf2030b}{reg16};
\hypertarget{a00041_source_l00151}{}\hyperlink{a00016_a83e2be8d3feb1bcbc286bfaae10ac552}{00151}         uint32\_t        \hyperlink{a00016_a83e2be8d3feb1bcbc286bfaae10ac552}{reg32};
00152     \}\hyperlink{a00041_a638e4503e0ae6ce655b7ad2e17e8f0ad}{value} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00153 
\hypertarget{a00041_source_l00154}{}\hyperlink{a00041_a0c22d234d52e616d449a8c264bf2030b}{00154}     \}msg\_fields  \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
\hypertarget{a00041_source_l00155}{}\hyperlink{a00041_a83e2be8d3feb1bcbc286bfaae10ac552}{00155}     
00156 \}\hyperlink{a00016}{ade7880\_read\_tx\_buff\_ut};
00157 
00158 
00159 
00160 
\hypertarget{a00041_source_l00162}{}\hyperlink{a00020}{00162} \textcolor{keyword}{typedef} \textcolor{keyword}{union}
00163 \{
00164     uint8\_t msg\_all[\hyperlink{a00041_ac85ecf34a5cbd85d6dbd51b4c9a5469e}{WR\_MSG\_LENGTH} + \textcolor{keyword}{sizeof}(uint32\_t)]  
      \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00165     
00166     \textcolor{keyword}{struct}
00167     \{   
\hypertarget{a00041_source_l00168}{}\hyperlink{a00020_af6a65bac733ea3e9b1d24b065163d49a}{00168}     \hyperlink{a00011}{address\_byte\_ut} \hyperlink{a00020_af6a65bac733ea3e9b1d24b065163d49a}{address\_byte};
00169     uint16\_t        target\_register \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00170     \textcolor{keyword}{union}\{
\hypertarget{a00041_source_l00171}{}\hyperlink{a00020_a90b3f782e917edca7101e7803a3773b7}{00171}         uint8\_t         \hyperlink{a00020_a90b3f782e917edca7101e7803a3773b7}{reg8};
\hypertarget{a00041_source_l00172}{}\hyperlink{a00020_a0c22d234d52e616d449a8c264bf2030b}{00172}         uint16\_t        \hyperlink{a00020_a0c22d234d52e616d449a8c264bf2030b}{reg16};
\hypertarget{a00041_source_l00173}{}\hyperlink{a00020_a83e2be8d3feb1bcbc286bfaae10ac552}{00173}         uint32\_t        \hyperlink{a00020_a83e2be8d3feb1bcbc286bfaae10ac552}{reg32};
00174     \}\hyperlink{a00041_a638e4503e0ae6ce655b7ad2e17e8f0ad}{value} \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
00175 
00176     \}msg\_fields  \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00177     
00178 \}\hyperlink{a00020}{ade7880\_write\_tx\_buff\_ut};
00179 
00180 
00181 
\hypertarget{a00041_source_l00183}{}\hyperlink{a00012}{00183} \textcolor{keyword}{typedef} \textcolor{keyword}{union}
00184 \{
00185     uint8\_t msg\_all[\textcolor{keyword}{sizeof}(uint16\_t)+ 2*\textcolor{keyword}{sizeof}(uint8\_t)]  \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00186     
00187     \textcolor{keyword}{struct}
00188     \{   
\hypertarget{a00041_source_l00189}{}\hyperlink{a00012_af6a65bac733ea3e9b1d24b065163d49a}{00189}     \hyperlink{a00011}{address\_byte\_ut} \hyperlink{a00012_af6a65bac733ea3e9b1d24b065163d49a}{address\_byte};
00190     uint16\_t        target\_register \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((packed));
\hypertarget{a00041_source_l00191}{}\hyperlink{a00012_a638e4503e0ae6ce655b7ad2e17e8f0ad}{00191}     uint8\_t         \hyperlink{a00012_a638e4503e0ae6ce655b7ad2e17e8f0ad}{value};
00192     \}msg\_fields  \hyperlink{a00041_a93c867902b57f5986f7dc397bd28f600}{\_\_attribute\_\_} ((aligned));
00193     
00194 \}\hyperlink{a00012}{ade7880\_ram\_lock\_msg\_ut};
\hypertarget{a00041_source_l00195}{}\hyperlink{a00041_a638e4503e0ae6ce655b7ad2e17e8f0ad}{00195} 
00196 
00197 
00198 
00199 uint32\_t \hyperlink{a00007_ga7ad9f65ee46aca507374096506a0b1c4}{spi\_read}(uint8\_t chip\_select,uint8\_t chip\_address,uint16\_t target\_register,uint8\_t reg\_len
      );
00200 int8\_t   \hyperlink{a00007_ga2770219ad8ad1eda1817c0df934b47d0}{spi\_write}(uint8\_t chip\_select,uint8\_t chip\_address,uint16\_t target\_register,int32\_t 
      \hyperlink{a00041_a638e4503e0ae6ce655b7ad2e17e8f0ad}{value},uint8\_t reg\_len);
00201 
00202 \textcolor{preprocessor}{#ifdef DEBUG}
00203 \textcolor{preprocessor}{}\textcolor{keywordtype}{void} spi\_enable\_msg\_debug\_print(uint8\_t cmd);
00204 \textcolor{preprocessor}{#endif}
00205 \textcolor{preprocessor}{}
00206 
00207 
00208 
00209 
00210 
00211 
00212 \textcolor{preprocessor}{#endif }
00213 \textcolor{preprocessor}{}
00214 
\end{DoxyCode}
